# レポート ― 軌道要素に対する摂動（J₂・J₃・大気抗力）

*(Markdown 上のプレーンテキスト数式／擬似コード、LaTeX 不使用)*

---

## 0. 対象範囲と記号

| 記号      | 意味（単位：SI 系）                                                  |
| ------- | ------------------------------------------------------------ |
| μ       | 地球の万有引力定数 GM = 3.986 004 418 × 10¹⁴ m³ s⁻²                   |
| Rₑ      | 地球平均赤道半径 = 6 378 137 m                                       |
| J₂, J₃  | 第 2 次・第 3 次ゾーナル調和項（J₂ ≈ 1.082 63 × 10⁻³, J₃ ≈ –2.532 × 10⁻⁶） |
| a, e, i | 半長軸，離心率，軌道傾斜角                                                |
| Ω       | 昇交点赤経（RAAN）                                                  |
| ω       | 近地点引数                                                        |
| M       | 平均近点角                                                        |
| n       | ケプラー平均運動 = √(μ / a³)                                         |
| B       | 弾道係数 = C\_D A ⁄ m（m² kg⁻¹）                                   |
| ρ       | 局所大気密度（kg m⁻³）                                               |
| v\_rel  | 大気に対する相対速度（m s⁻¹）                                            |

以下は周回平均した **長周期（セキュラ）項** のみを示す。短周期成分は省略。

---

## 1. J₂ による摂動（第 2 次ゾーナル）

```
k2 = 1.5 * J2 * (R_e^2)
β  = (1 - e^2)^2
dΩ/dt = - k2 * n * cos(i) / (a^2 * β)                     (1)
dω/dt =   k2 * n * (2 - 2.5 * sin(i)^2) / (a^2 * β)       (2)
dM/dt =   n + k2 * n * (1 - 3 * sin(i)^2) / (2 * a^2 * β) (3)
da/dt = de/dt = di/dt = 0   （一次近似）
```

*式 (1)* は昇交点の歳差（順行軌道では西向き）。
*式 (2)* は近地点引数のドリフト（臨界傾斜 63.4° でゼロ）。
*式 (3)* は平均近点角（平均運動）への補正。

---

## 2. J₃ による摂動（第 3 次ゾーナル）

```
k3 = 0.5 * J3 * (R_e^3)
γ  = (1 - e^2)^3
dΩ/dt += - k3 * n * sin(i) / (a^3 * γ)                         (4)
dω/dt +=   k3 * n * (4 - 5 * sin(i)^2) * sin(i) / (2*a^3*γ)    (5)
de/dt  =   k3 * n * (1.5 * sin(i)^2 - 1) * e / (a^3 * γ)       (6)
di/dt  =   k3 * n * cos(i) / (2 * a^3 * γ)                     (7)
```

J₃ は地球の「洋梨形」非対称を反映し、e と i をゆっくり変化させるほか、Ω と ω に追加ドリフトを与える。J₂ より 2 桁小さいが、長寿命 LEO や高楕円軌道では無視できない。

---

## 3. 大気抵抗による摂動

速度と逆向きに働く抗力加速度 **a\_d** を

```
a_d = -½ * ρ * v_rel^2 * B * v̂
```

とすると、ガウス変分方程式を周回平均して主要項だけ残すと：

```
P = sqrt(μ * a)                    # 半通径の近似補助
F = ρ * v_rel * B                  # 1/m 換算の抗力
da/dt = -2 * a * F                 (8)
de/dt ≈ -F * (2/π) * a * e         (9)
di/dt, dΩ/dt, dω/dt ≈ 0（抗力はほぼ対称）
```

*大気密度 ρ*：簡易指数モデル
ρ(h) = ρ₀ · exp(-(h - h₀)/H)
または NRLMSISE-00 を使用。
*v\_rel*：円軌道近似で √(μ/a) から地球自転速度を差し引く。

---

## 4. 擬似コード例

```python
# 入力: a, e, i, Ω, ω, M (単位: rad, m)、タイムステップ dt (s)、反復回数 N
mu  = 3.986004418e14
Re  = 6378137.0
J2  = 1.08263e-3
J3  = -2.532e-6
CdA_over_m = 0.012  # 例としての弾道係数 B

for step in range(N):
    n = (mu / a**3) ** 0.5
    beta  = (1 - e**2)**2
    gamma = (1 - e**2)**3
    k2 = 1.5 * J2 * Re**2
    k3 = 0.5 * J3 * Re**3

    # ---- J2 ----
    dΩ = (-k2 * n * math.cos(i) / (a**2 * beta)) * dt
    dω = ( k2 * n * (2 - 2.5 * math.sin(i)**2) / (a**2 * beta)) * dt
    dM = ( n + k2 * n * (1 - 3 * math.sin(i)**2) / (2 * a**2 * beta) ) * dt

    # ---- J3 ----
    dΩ += (-k3 * n * math.sin(i) / (a**3 * gamma)) * dt
    dω += ( k3 * n * (4 - 5 * math.sin(i)**2) * math.sin(i) / (2*a**3*gamma)) * dt
    de  = ( k3 * n * (1.5 * math.sin(i)**2 - 1) * e / (a**3 * gamma) ) * dt
    di  = ( k3 * n * math.cos(i) / (2 * a**3 * gamma) ) * dt

    # ---- 大気抵抗 ----
    h = a * (1 - e) - Re                    # 近地点高度（粗い近似）
    rho = rho0 * math.exp(-(h - h0)/H)      # 簡易モデル
    v_rel = (mu / a) ** 0.5                 # 平均速度
    F = 0.5 * rho * v_rel**2 * CdA_over_m
    da  = -2 * a * F * dt
    de += -F * (2/math.pi) * a * e * dt     # 抗力分を上乗せ

    # ---- 更新 ----
    a += da
    e += de
    i += di
    Ω += dΩ
    ω += dω
    M += dM
```

**メモ**

* ρ₀, h₀, H は大気モデルに応じて設定。
* 高精度には Runge–Kutta 4 などで積分し、**a\_J2**, **a\_J3**, **a\_drag** をデカルト座標で加える完全数値積分を推奨。

---

## 5. 参考文献（邦題略）

1. Vallado, *Fundamentals of Astrodynamics and Applications*, 4th ed.
2. Montenbruck & Gill, *Satellite Orbits*.
3. Wertz et al., *Space Mission Engineering*.
4. “SPG4/8 Theory” (NASA TD546) ― 公式ドラッグモデル解説。

---

*作成日: 2025-06-07*
